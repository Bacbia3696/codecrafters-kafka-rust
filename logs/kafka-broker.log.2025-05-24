[2m2025-05-24T02:34:37.921978+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::logging[0m[2m:[0m Logging system initialized [3mconfig[0m[2m=[0mLogConfig { level: "info", console: true, file: true, log_dir: "./logs", file_prefix: "kafka-broker", json_format: false, with_timestamp: true, with_thread_ids: true, with_spans: true }
[2m2025-05-24T02:34:37.922035+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::logging[0m[2m:[0m Kafka broker started [3maddr[0m[2m=[0m127.0.0.1:9092 [3mversion[0m[2m=[0m"0.1.0"
[2m2025-05-24T02:34:37.922116+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Server listening for connections [3maddr[0m[2m=[0m127.0.0.1:9092
[2m2025-05-24T02:34:46.530885+00:00[0m [32m INFO[0m ThreadId(03) [2mcodecrafters_kafka::network::server[0m[2m:[0m Received SIGTERM signal
[2m2025-05-24T02:34:46.531096+00:00[0m [32m INFO[0m ThreadId(03) [2mcodecrafters_kafka::network::server[0m[2m:[0m Shutdown signal received, initiating graceful shutdown
[2m2025-05-24T02:34:46.531336+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Server shutdown initiated
[2m2025-05-24T02:34:46.531430+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Waiting for active connections to finish
[2m2025-05-24T02:34:46.633081+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m All connections finished gracefully
[2m2025-05-24T02:34:46.633262+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Network server shutdown complete
[2m2025-05-24T02:34:46.633557+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::logging[0m[2m:[0m Kafka broker shutdown completed gracefully [3mactive_connections[0m[2m=[0m0
[2m2025-05-24T02:34:52.672575+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::logging[0m[2m:[0m Logging system initialized [3mconfig[0m[2m=[0mLogConfig { level: "info", console: true, file: true, log_dir: "./logs", file_prefix: "kafka-broker", json_format: false, with_timestamp: true, with_thread_ids: true, with_spans: true }
[2m2025-05-24T02:34:52.672601+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::logging[0m[2m:[0m Kafka broker started [3maddr[0m[2m=[0m127.0.0.1:9092 [3mversion[0m[2m=[0m"0.1.0"
[2m2025-05-24T02:34:52.672668+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Server listening for connections [3maddr[0m[2m=[0m127.0.0.1:9092
[2m2025-05-24T02:34:58.923173+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Accepted new connection [3mpeer_addr[0m[2m=[0m127.0.0.1:62782
[2m2025-05-24T02:34:58.923405+00:00[0m [32m INFO[0m ThreadId(08) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:62782[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m new
[2m2025-05-24T02:34:58.923493+00:00[0m [32m INFO[0m ThreadId(08) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:62782[1m}[0m[2m:[0m[1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1 [3mclient_id[0m[2m=[0m"test-client"[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m new
[2m2025-05-24T02:34:58.923532+00:00[0m [32m INFO[0m ThreadId(08) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:62782[1m}[0m[2m:[0m[1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1 [3mclient_id[0m[2m=[0m"test-client"[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m Request processed successfully [3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1 [3mrequest_size[0m[2m=[0m22 [3mresponse_size[0m[2m=[0m24 [3mprocessing_time_ms[0m[2m=[0m0
[2m2025-05-24T02:34:58.923571+00:00[0m [32m INFO[0m ThreadId(08) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:62782[1m}[0m[2m:[0m[1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1 [3mclient_id[0m[2m=[0m"test-client"[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m close [3mtime.busy[0m[2m=[0m44.2Âµs [3mtime.idle[0m[2m=[0m50.9Âµs
[2m2025-05-24T02:34:58.923816+00:00[0m [32m INFO[0m ThreadId(04) [1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m3 [3mcorrelation_id[0m[2m=[0m2[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m new
[2m2025-05-24T02:34:58.923856+00:00[0m [33m WARN[0m ThreadId(04) [1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m3 [3mcorrelation_id[0m[2m=[0m2[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Unsupported API key, returning error response [3mapi_key[0m[2m=[0m3
[2m2025-05-24T02:34:58.923882+00:00[0m [33m WARN[0m ThreadId(04) [1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m3 [3mcorrelation_id[0m[2m=[0m2[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Generating error response for unsupported API [3mapi_key[0m[2m=[0m3
[2m2025-05-24T02:34:58.923911+00:00[0m [32m INFO[0m ThreadId(04) [1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m3 [3mcorrelation_id[0m[2m=[0m2[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m Request processed successfully [3mapi_key[0m[2m=[0m3 [3mcorrelation_id[0m[2m=[0m2 [3mrequest_size[0m[2m=[0m15 [3mresponse_size[0m[2m=[0m10 [3mprocessing_time_ms[0m[2m=[0m0
[2m2025-05-24T02:34:58.923945+00:00[0m [32m INFO[0m ThreadId(04) [1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m3 [3mcorrelation_id[0m[2m=[0m2[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m close [3mtime.busy[0m[2m=[0m94.7Âµs [3mtime.idle[0m[2m=[0m60.7Âµs
[2m2025-05-24T02:34:58.923990+00:00[0m [32m INFO[0m ThreadId(04) [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Client disconnected [3mpeer_addr[0m[2m=[0m127.0.0.1:62782
[2m2025-05-24T02:34:58.924027+00:00[0m [32m INFO[0m ThreadId(04) [2mcodecrafters_kafka::network::server[0m[2m:[0m Connection handled successfully [3mduration_ms[0m[2m=[0m0
[2m2025-05-24T02:35:03.944988+00:00[0m [32m INFO[0m ThreadId(04) [2mcodecrafters_kafka::network::server[0m[2m:[0m Received SIGTERM signal
[2m2025-05-24T02:35:03.945050+00:00[0m [32m INFO[0m ThreadId(04) [2mcodecrafters_kafka::network::server[0m[2m:[0m Shutdown signal received, initiating graceful shutdown
[2m2025-05-24T02:35:03.945156+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Server shutdown initiated
[2m2025-05-24T02:35:03.945184+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Waiting for active connections to finish
[2m2025-05-24T02:35:04.046702+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m All connections finished gracefully
[2m2025-05-24T02:35:04.046737+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Network server shutdown complete
[2m2025-05-24T02:35:04.046796+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::logging[0m[2m:[0m Kafka broker shutdown completed gracefully [3mactive_connections[0m[2m=[0m0
[2m2025-05-24T02:35:38.158479+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::logging[0m[2m:[0m Logging system initialized [3mconfig[0m[2m=[0mLogConfig { level: "info", console: true, file: true, log_dir: "./logs", file_prefix: "kafka-broker", json_format: false, with_timestamp: true, with_thread_ids: true, with_spans: true }
[2m2025-05-24T02:35:38.158512+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::logging[0m[2m:[0m Kafka broker started [3maddr[0m[2m=[0m127.0.0.1:9092 [3mversion[0m[2m=[0m"0.1.0"
[2m2025-05-24T02:35:38.158584+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Server listening for connections [3maddr[0m[2m=[0m127.0.0.1:9092
[2m2025-05-24T02:35:54.678074+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Accepted new connection [3mpeer_addr[0m[2m=[0m127.0.0.1:62852
[2m2025-05-24T02:35:54.678470+00:00[0m [32m INFO[0m ThreadId(08) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:62852[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m new
[2m2025-05-24T02:35:54.678589+00:00[0m [31mERROR[0m ThreadId(08) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:62852[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Failed to read message data [3mpeer_addr[0m[2m=[0m127.0.0.1:62852 [3merror[0m[2m=[0mearly eof [3mexpected_bytes[0m[2m=[0m35
[2m2025-05-24T02:35:54.678703+00:00[0m [31mERROR[0m ThreadId(08) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:62852[1m}[0m[2m:[0m [2mcodecrafters_kafka::network::server[0m[2m:[0m Error handling connection [3merror[0m[2m=[0mearly eof [3mduration_ms[0m[2m=[0m0
[2m2025-05-24T02:35:54.678758+00:00[0m [32m INFO[0m ThreadId(08) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:62852[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m close [3mtime.busy[0m[2m=[0m225Âµs [3mtime.idle[0m[2m=[0m106Âµs
[2m2025-05-24T02:37:40.051594+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Accepted new connection [3mpeer_addr[0m[2m=[0m127.0.0.1:62982
[2m2025-05-24T02:37:40.051789+00:00[0m [32m INFO[0m ThreadId(08) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:62982[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m new
[2m2025-05-24T02:37:40.051901+00:00[0m [31mERROR[0m ThreadId(08) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:62982[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Failed to read message data [3mpeer_addr[0m[2m=[0m127.0.0.1:62982 [3merror[0m[2m=[0mearly eof [3mexpected_bytes[0m[2m=[0m35
[2m2025-05-24T02:37:40.051985+00:00[0m [31mERROR[0m ThreadId(08) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:62982[1m}[0m[2m:[0m [2mcodecrafters_kafka::network::server[0m[2m:[0m Error handling connection [3merror[0m[2m=[0mearly eof [3mduration_ms[0m[2m=[0m0
[2m2025-05-24T02:37:40.052052+00:00[0m [32m INFO[0m ThreadId(08) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:62982[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m close [3mtime.busy[0m[2m=[0m184Âµs [3mtime.idle[0m[2m=[0m120Âµs
[2m2025-05-24T02:42:13.779148+00:00[0m [32m INFO[0m ThreadId(09) [2mcodecrafters_kafka::network::server[0m[2m:[0m Received SIGINT signal
[2m2025-05-24T02:42:13.779309+00:00[0m [32m INFO[0m ThreadId(09) [2mcodecrafters_kafka::network::server[0m[2m:[0m Shutdown signal received, initiating graceful shutdown
[2m2025-05-24T02:42:13.779450+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Server shutdown initiated
[2m2025-05-24T02:42:13.779501+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Waiting for active connections to finish
[2m2025-05-24T02:42:13.882081+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m All connections finished gracefully
[2m2025-05-24T02:42:13.882277+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Network server shutdown complete
[2m2025-05-24T02:42:13.882508+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::logging[0m[2m:[0m Kafka broker shutdown completed gracefully [3mactive_connections[0m[2m=[0m0
[2m2025-05-24T02:42:22.133377+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::logging[0m[2m:[0m Logging system initialized [3mconfig[0m[2m=[0mLogConfig { level: "debug", console: true, file: true, log_dir: "./logs", file_prefix: "kafka-broker", json_format: false, with_timestamp: true, with_thread_ids: true, with_spans: true }
[2m2025-05-24T02:42:22.133409+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::logging[0m[2m:[0m Kafka broker started [3maddr[0m[2m=[0m127.0.0.1:9092 [3mversion[0m[2m=[0m"0.1.0"
[2m2025-05-24T02:42:22.133479+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Server listening for connections [3maddr[0m[2m=[0m127.0.0.1:9092
[2m2025-05-24T02:42:25.891944+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Accepted new connection [3mpeer_addr[0m[2m=[0m127.0.0.1:63227
[2m2025-05-24T02:42:25.892403+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63227[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m new
[2m2025-05-24T02:42:25.892490+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63227[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Starting connection handling [3mpeer_addr[0m[2m=[0m127.0.0.1:63227
[2m2025-05-24T02:42:25.892548+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63227[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Read message length prefix [3mpeer_addr[0m[2m=[0m127.0.0.1:63227 [3mmessage_length[0m[2m=[0m35
[2m2025-05-24T02:42:25.892633+00:00[0m [31mERROR[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63227[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Failed to read message data [3mpeer_addr[0m[2m=[0m127.0.0.1:63227 [3merror[0m[2m=[0mearly eof [3mexpected_bytes[0m[2m=[0m35
[2m2025-05-24T02:42:25.892775+00:00[0m [31mERROR[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63227[1m}[0m[2m:[0m [2mcodecrafters_kafka::network::server[0m[2m:[0m Error handling connection [3merror[0m[2m=[0mearly eof [3mduration_ms[0m[2m=[0m0
[2m2025-05-24T02:42:25.892846+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63227[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m close [3mtime.busy[0m[2m=[0m369Âµs [3mtime.idle[0m[2m=[0m119Âµs
[2m2025-05-24T02:45:05.755008+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Accepted new connection [3mpeer_addr[0m[2m=[0m127.0.0.1:63396
[2m2025-05-24T02:45:05.755198+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63396[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m new
[2m2025-05-24T02:45:05.755276+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63396[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Starting connection handling [3mpeer_addr[0m[2m=[0m127.0.0.1:63396
[2m2025-05-24T02:45:05.755333+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63396[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Read message length prefix [3mpeer_addr[0m[2m=[0m127.0.0.1:63396 [3mmessage_length[0m[2m=[0m35
[2m2025-05-24T02:45:05.755393+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63396[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Successfully read message data [3mpeer_addr[0m[2m=[0m127.0.0.1:63396 [3mbytes_read[0m[2m=[0m35
[2m2025-05-24T02:45:05.755460+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63396[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Successfully parsed request header [3mpeer_addr[0m[2m=[0m127.0.0.1:63396 [3mapi_key[0m[2m=[0m18 [3mapi_version[0m[2m=[0m4 [3mcorrelation_id[0m[2m=[0m1870644833 [3mclient_id[0m[2m=[0mSome("kafka-cli")
[2m2025-05-24T02:45:05.755529+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63396[1m}[0m[2m:[0m[1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1870644833 [3mclient_id[0m[2m=[0m"kafka-cli"[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m new
[2m2025-05-24T02:45:05.755597+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63396[1m}[0m[2m:[0m[1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1870644833 [3mclient_id[0m[2m=[0m"kafka-cli"[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Processing ApiVersions request
[2m2025-05-24T02:45:05.755638+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63396[1m}[0m[2m:[0m[1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1870644833 [3mclient_id[0m[2m=[0m"kafka-cli"[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Generating ApiVersions response
[2m2025-05-24T02:45:05.755683+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63396[1m}[0m[2m:[0m[1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1870644833 [3mclient_id[0m[2m=[0m"kafka-cli"[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Generated ApiVersions response [3mresponse_length[0m[2m=[0m16
[2m2025-05-24T02:45:05.755737+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63396[1m}[0m[2m:[0m[1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1870644833 [3mclient_id[0m[2m=[0m"kafka-cli"[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m Request processed successfully [3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1870644833 [3mrequest_size[0m[2m=[0m35 [3mresponse_size[0m[2m=[0m24 [3mprocessing_time_ms[0m[2m=[0m0
[2m2025-05-24T02:45:05.755802+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63396[1m}[0m[2m:[0m[1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1870644833 [3mclient_id[0m[2m=[0m"kafka-cli"[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m close [3mtime.busy[0m[2m=[0m197Âµs [3mtime.idle[0m[2m=[0m97.5Âµs
[2m2025-05-24T02:45:05.755875+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63396[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Sent response successfully [3mpeer_addr[0m[2m=[0m127.0.0.1:63396 [3mresponse_length[0m[2m=[0m24
[2m2025-05-24T02:45:05.755926+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63396[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Client disconnected [3mpeer_addr[0m[2m=[0m127.0.0.1:63396
[2m2025-05-24T02:45:05.755963+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63396[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Connection handling completed [3mpeer_addr[0m[2m=[0m127.0.0.1:63396
[2m2025-05-24T02:45:05.756026+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63396[1m}[0m[2m:[0m [2mcodecrafters_kafka::network::server[0m[2m:[0m Connection handled successfully [3mduration_ms[0m[2m=[0m0
[2m2025-05-24T02:45:05.756077+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63396[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m close [3mtime.busy[0m[2m=[0m809Âµs [3mtime.idle[0m[2m=[0m107Âµs
[2m2025-05-24T02:50:48.736761+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Accepted new connection [3mpeer_addr[0m[2m=[0m127.0.0.1:63703
[2m2025-05-24T02:50:48.736948+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63703[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m new
[2m2025-05-24T02:50:48.737040+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63703[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Starting connection handling [3mpeer_addr[0m[2m=[0m127.0.0.1:63703
[2m2025-05-24T02:50:48.737091+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63703[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Read message length prefix [3mpeer_addr[0m[2m=[0m127.0.0.1:63703 [3mmessage_length[0m[2m=[0m35
[2m2025-05-24T02:50:48.737139+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63703[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Successfully read message data [3mpeer_addr[0m[2m=[0m127.0.0.1:63703 [3mbytes_read[0m[2m=[0m35
[2m2025-05-24T02:50:48.737239+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63703[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Successfully parsed request header [3mpeer_addr[0m[2m=[0m127.0.0.1:63703 [3mapi_key[0m[2m=[0m18 [3mapi_version[0m[2m=[0m4 [3mcorrelation_id[0m[2m=[0m1870644833 [3mclient_id[0m[2m=[0mSome("kafka-cli")
[2m2025-05-24T02:50:48.737397+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63703[1m}[0m[2m:[0m[1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1870644833 [3mclient_id[0m[2m=[0m"kafka-cli"[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m new
[2m2025-05-24T02:50:48.737529+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63703[1m}[0m[2m:[0m[1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1870644833 [3mclient_id[0m[2m=[0m"kafka-cli"[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Processing ApiVersions request
[2m2025-05-24T02:50:48.737613+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63703[1m}[0m[2m:[0m[1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1870644833 [3mclient_id[0m[2m=[0m"kafka-cli"[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Generating ApiVersions response
[2m2025-05-24T02:50:48.737658+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63703[1m}[0m[2m:[0m[1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1870644833 [3mclient_id[0m[2m=[0m"kafka-cli"[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Generated ApiVersions response [3mresponse_length[0m[2m=[0m16
[2m2025-05-24T02:50:48.737712+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63703[1m}[0m[2m:[0m[1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1870644833 [3mclient_id[0m[2m=[0m"kafka-cli"[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m Request processed successfully [3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1870644833 [3mrequest_size[0m[2m=[0m35 [3mresponse_size[0m[2m=[0m24 [3mprocessing_time_ms[0m[2m=[0m0
[2m2025-05-24T02:50:48.737781+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63703[1m}[0m[2m:[0m[1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1870644833 [3mclient_id[0m[2m=[0m"kafka-cli"[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m close [3mtime.busy[0m[2m=[0m245Âµs [3mtime.idle[0m[2m=[0m177Âµs
[2m2025-05-24T02:50:48.737863+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63703[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Sent response successfully [3mpeer_addr[0m[2m=[0m127.0.0.1:63703 [3mresponse_length[0m[2m=[0m24
[2m2025-05-24T02:50:48.737919+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63703[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Client disconnected [3mpeer_addr[0m[2m=[0m127.0.0.1:63703
[2m2025-05-24T02:50:48.737954+00:00[0m [34mDEBUG[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63703[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Connection handling completed [3mpeer_addr[0m[2m=[0m127.0.0.1:63703
[2m2025-05-24T02:50:48.738011+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63703[1m}[0m[2m:[0m [2mcodecrafters_kafka::network::server[0m[2m:[0m Connection handled successfully [3mduration_ms[0m[2m=[0m1
[2m2025-05-24T02:50:48.738056+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:63703[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m close [3mtime.busy[0m[2m=[0m1.03ms [3mtime.idle[0m[2m=[0m114Âµs
[2m2025-05-24T02:58:57.646233+00:00[0m [32m INFO[0m ThreadId(03) [2mcodecrafters_kafka::network::server[0m[2m:[0m Received SIGINT signal
[2m2025-05-24T02:58:57.646353+00:00[0m [32m INFO[0m ThreadId(03) [2mcodecrafters_kafka::network::server[0m[2m:[0m Shutdown signal received, initiating graceful shutdown
[2m2025-05-24T02:58:57.646434+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Server shutdown initiated
[2m2025-05-24T02:58:57.646474+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Waiting for active connections to finish
[2m2025-05-24T02:58:57.748901+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m All connections finished gracefully
[2m2025-05-24T02:58:57.749063+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Network server shutdown complete
[2m2025-05-24T02:58:57.749351+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::logging[0m[2m:[0m Kafka broker shutdown completed gracefully [3mactive_connections[0m[2m=[0m0
[2m2025-05-24T02:59:00.870122+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::logging[0m[2m:[0m Logging system initialized [3mconfig[0m[2m=[0mLogConfig { level: "info", console: true, file: true, log_dir: "./logs", file_prefix: "kafka-broker", json_format: false, with_timestamp: true, with_thread_ids: true, with_spans: true }
[2m2025-05-24T02:59:00.870158+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::logging[0m[2m:[0m Kafka broker started [3maddr[0m[2m=[0m127.0.0.1:9092 [3mversion[0m[2m=[0m"0.1.0"
[2m2025-05-24T02:59:00.870246+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Server listening for connections [3maddr[0m[2m=[0m127.0.0.1:9092
[2m2025-05-24T02:59:02.020962+00:00[0m [32m INFO[0m ThreadId(01) [2mcodecrafters_kafka::network::server[0m[2m:[0m Accepted new connection [3mpeer_addr[0m[2m=[0m127.0.0.1:64316
[2m2025-05-24T02:59:02.021534+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:64316[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m new
[2m2025-05-24T02:59:02.021769+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:64316[1m}[0m[2m:[0m[1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1870644833 [3mclient_id[0m[2m=[0m"kafka-cli"[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m new
[2m2025-05-24T02:59:02.021866+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:64316[1m}[0m[2m:[0m[1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1870644833 [3mclient_id[0m[2m=[0m"kafka-cli"[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m Request processed successfully [3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1870644833 [3mrequest_size[0m[2m=[0m35 [3mresponse_size[0m[2m=[0m20 [3mprocessing_time_ms[0m[2m=[0m0
[2m2025-05-24T02:59:02.021979+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:64316[1m}[0m[2m:[0m[1mrequest[0m[1m{[0m[3mapi_key[0m[2m=[0m18 [3mcorrelation_id[0m[2m=[0m1870644833 [3mclient_id[0m[2m=[0m"kafka-cli"[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m close [3mtime.busy[0m[2m=[0m132Âµs [3mtime.idle[0m[2m=[0m116Âµs
[2m2025-05-24T02:59:02.022389+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:64316[1m}[0m[2m:[0m [2mcodecrafters_kafka::kafka::broker[0m[2m:[0m Client disconnected [3mpeer_addr[0m[2m=[0m127.0.0.1:64316
[2m2025-05-24T02:59:02.022494+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:64316[1m}[0m[2m:[0m [2mcodecrafters_kafka::network::server[0m[2m:[0m Connection handled successfully [3mduration_ms[0m[2m=[0m1
[2m2025-05-24T02:59:02.022543+00:00[0m [32m INFO[0m ThreadId(09) [1mconnection[0m[1m{[0m[3mpeer_addr[0m[2m=[0m127.0.0.1:64316[1m}[0m[2m:[0m [2mcodecrafters_kafka::logging[0m[2m:[0m close [3mtime.busy[0m[2m=[0m911Âµs [3mtime.idle[0m[2m=[0m188Âµs
